# API-сервис сокращения ссылок

## API

- **POST** /links/shorten – создание короткой ссылки с помощью генерации уникального кода либо строки пользователя
 
  Параметеры:
  - **expires_at** - дата удаления ссылки с точностью до минуты в формате **2025-04-01T20:37**, параметр необязателен
  - **user_id** - идентификатор пользователя, если тот залогинен
    
  Формат JSON:
  ```
  {
    "original_url": "string",
    "custom_alias": "string"
  }
  ```
  - **original_url** - оригинальный url для создания короткой ссылки
  - **custom_alias** - строка для создания кастомной короткой ссылки, необязательный параметр, проверяется на уникальность

- **GET** /links/{short_code} – перенаправление на оригинальный URL по коду
- **DELETE** /links/{short_code} – удаление короткой ссылки, метод доступен только зарегистрированным поьзователям
- **PUT** /links/{short_code} – обновление кода короткой ссылки, метод доступен только зарегистрированным поьзователям

- **GET** /links/{short_code}/stats - получение статистики по короткой ссылке: даты создания, количества переходов и даты последнего использования

- **GET** /links/search?original_url={url} - поиск короткой ссылки по оригинальному URL


- Дополнительная функциональность:
  - **GET** /links/all - получение всех активных коротких ссылок пользователя с информацией о них, метод доступен только зарегистрированным поьзователям
  - **GET** /links/history_expired - отображение истории всех истекших ссылок пользователя с информацией о них, метод доступен только зарегистрированным поьзователям

## Запуск приложения
```docker compose up --build```

##  База данных
**PostgreSQL**

Таблицы:
- **user**
- **link**

**user**:
- **id**, integer: идентификатор пользователя
- **email**, string: почта
- **hashed_password**, string: захешированный пароль
- **is_active**, boolean: индикатор, что пользователь залогинен
- **is_superuser**, boolean: индикатор, что пользователь является суперюзером (поле не используется в приложении)
- **is_verified**, boolean: индикатор, что пользователь прошел верификацию (поле не используется в приложении)

**link**:
- **id**, integer: идентификатор ссылки
- **original_url**, string: оригинальный url ссылки
- **short_code**, string: уникальный код короткой ссылки
- **creation_date**, timestamp: дата создания короткой ссылки
- **expires_at**, timestamp: дата удаления ссылки с точностью до минуты, может быть **null**
- **clicks_count**, integer: количество переходов по ссылке
- **last_usage_at**, timestamp: дата последнего использования, может быть **null**
- **deleted**, boolean: индикатор того, что ссылка удалена
- **user_id**, integer: идентификатор пользователя, внешний ключ на таблицу **user**, может быть **null**
